App As appinfo:
    BackEnabled: =false
    OnStart: |-
        =//Variables de Bienvenida
        Set(varBCBD,true);
        Set(varBCCS,false);
        Set(varBVDU,false);
        Set(MyUserID,UsuariosdeOffice365.MyProfile().Id);
        //PopUp Validacion Usuario
        Set(valUsr,LookUp(Empleado,Nombre_Usuario.Email=User().Email,Estatus_Empleado));
        Set(popUpUsr,If(valUsr="Activo","false","true"));
        Set(varUserExist,If(IsEmpty(Filter(Empleado,Nombre_Usuario.DisplayName=User().FullName))="true","false","true"));
        Set(popValObj,If(CountRows(GalleryObjetivoEmp.AllItems)=0,"true","false"));
        Set(varPopUpMail,false);
        //Set(popUp;If(popUpUsr="true" && VarpopUpComprobacion="false";"false"));;
        Set(usuarioAdministrador,If(LookUp(Empleado,Nombre_Usuario.Email=User().Email,Tipo_Acceso)="Administrador",false,true));
        //Obtener ID Usuario
        Set(valUsr2,LookUp(Empleado,Nombre_Usuario.Email=User().Email,ID));
        Set(valUsrIDEm,LookUp(Empleado,Nombre_Usuario.Email=User().Email,Title));
        Set(valUsrResp,LookUp(Empleado,Nombre_Usuario.Email=User().Email,Departamento));
        Set(valUsrRespDir,LookUp(Empleado,Nombre_Usuario.Email=User().Email,Direccion));
        Set(valUsrJefe,LookUp(Empleado,Nombre_Usuario.Email=User().Email,Responsable.DisplayName));
        Set(valUsrPuesto,LookUp(Empleado,Nombre=User().FullName,Puesto));
        //Coleccion Datos
        ClearCollect(
            RegistrosEmpleados,
            {
                IDempleado:valUsr2,
                TipoAcceso:"Usuario",
                Estatus:"Activo"
            }
        );
        
        //Coleccion Objetivos
        Set(
            VarIDOG,
            1
        );
        ClearCollect(
           RegistroResultadosClaveOG,
           {
               Co_ID:VarIDOG,
               Co_ResultadoClaveOG:"",
               Co_PeriodoTiempoOG:""
               
            }
        );
        
        //Coleccion Menu
        ClearCollect(
            Navegacion,
            Table(
                {
                    Titulo: "INICIO",
                    icono: Homen,
                    nav: scr_home
                },
                 {
                    Titulo: "OBJETIVO",
                    icono: objn,
                    nav:  scr_objetivo
                },
                {
                    Titulo: "AJUSTES",
                    icono: Ajustesn,
                    nav:  scr_configuracion
                },
                {
                    Titulo: "AYUDA",
                    icono: 'qm-ico',
                    nav:  scr_ayuda
                }  
            )
        );
        ClearCollect(
            MyPeerList,
            Filter(Empleado,Responsable.DisplayName=valUsrJefe)
        );
        Set(
            VarIDTR,
            1
        );
        ClearCollect(
            TareaRC,
            {
                Co_IDTarea:VarIDTR,
                Co_TitleTarea:"",
                CO_PeriodoTiempoTarea:"",
                Co_FITarea:"",
                Co_FFTarea:"",
                Co_IDResultadoClaveTarea:""
            }
        );
        Set(varlbtTituloObjetivo,"Detalle Objetivos");
        //Coleccion Ayuda OKRS
        ClearCollect(
            Ayuda,
            {
                Titulo:"Ventana de inicio",
                Descripcion:"En la ventana de inicio podras ver tanto los objetivos principales como los objetivos   del area",
                Imagen: '1-img'
            },
            {
                  Titulo:"Detalle de objetivos",
                  Descripcion:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",
                Imagen: '2-img'
            },
            {
                  Titulo:"Registro de objetivos",
                  Descripcion:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",
                Imagen: 'R1'
            },
            {
                  Titulo:"Registro de objetivos",
                  Descripcion:"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.",
                Imagen: 'ROK-img'
            }
        );
        //VarpopUpComprobacion=true
    StartScreen: =If(LookUp(Empleado,Nombre_Usuario.Email=User().Email,Puesto)="DGA DE TECNOLOGIAS DE INFORMACION",scr_objetivo)

